package ru.job4j.content;

import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.concurrent.ThreadLocalRandom;

@Component
public class ContentProviderText implements ContentProvider {
    private final Map<Boolean, List<String>> textRepository;

    public ContentProviderText() {
        this.textRepository = Map.of(
                true, List.of(
                        "Зафиксируйте этот момент — запишите в дневник, что вызывает вашу радость. Это станет ресурсом для сложных дней.",
                        "Поделитесь энергией — сделайте что-то приятное для другого человека. Доброта возвращается бумерангом.",
                        "Начните новый проект — ваша энергия идеальна для творчества или обучения. Что вы давно откладывали?",
                        "«Счастье не в обладании, а в наслаждении процессом» — наслаждайтесь текущим моментом.",
                        "Создайте «плейлист успеха» — сохраните музыку, фото, цитаты, которые ассоциируются с этим состоянием.",
                        "Планируйте маленькое приключение — поход на природу, гастрономический эксперимент, незнакомый маршрут.",
                        "«Сегодня ты там, где вчера мечтал быть» — поблагодарите себя за пройденный путь.",
                        "Практикуйте благодарность — напишите 3 вещи, за которые благодарны прямо сейчас.",
                        "Инвестируйте в будущее — займитесь спортом, прочтите полезную книгу, начните курс.",
                        "Улыбнитесь незнакомцу — положительные эмоции заразны в хорошем смысле."
                ),
                false, List.of(
                        "Это временно — помните, что чувства приходят и уходят, как волны. Позвольте себе просто быть.",
                        "«Даже самые темные ночи заканчиваются рассветом» — боль и печаль не вечны.",
                        "Микродействия — сделайте что-то очень маленькое: выпить стакан воды, заправить постель, открыть окно.",
                        "Техника «5-4-3-2-1» — назовите: 5 вещей, которые видите; 4 — которые слышите; 3 — которые чувствуете; 2 — которые ощущаете на запах; 1 — на вкус.",
                        "«Ты не обязан быть продуктивным в кризис» — иногда достаточно просто дышать.",
                        "Контейнирование эмоций — представьте, что складываете тяжелые чувства в воображаемую коробку на временное хранение.",
                        "Теплый напиток и уют — чай, плед, комфортная одежда — забота о теле помогает успокоить ум.",
                        "«Ты справился с 100% трудных дней до этого» — у вас есть внутренний ресурс.",
                        "Безоценочное наблюдение — опишите свое состояние без слов «плохо/хорошо»: «В груди тяжесть», «В глазах тепло».",
                        "Доступная поддержка — позвоните тому, кто просто выслушает, или напишите в дневник."
                )
        );
    }

    @Override
    public Content byMood(Long chatId, Long moodId, boolean isGood) {
        var content = new Content(chatId);

        String randomText = Optional.ofNullable(textRepository.get(isGood))
                .filter(list -> !list.isEmpty())
                .map(list -> list.get(ThreadLocalRandom.current().nextInt(list.size())))
                .orElse("Советы для этого настроения временно недоступны");
        content.setText(randomText);
        return content;
    }
}
